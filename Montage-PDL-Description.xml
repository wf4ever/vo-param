<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Service xmlns="http://www.ivoa.net/xml/PDL/v1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.ivoa.net/xml/Parameter/v0.1 PDL-V1.0.xsd">
    <ServiceId>http://dae81.iaa.es:8081/montage/OnlineCode</ServiceId>
    <ServiceName>Image Mosaicing Service</ServiceName>
    <Description>Prototype of a service to build and assemble reprojected astronomical images with Montage software tasks</Description>
    <Parameters>
        <parameter>
            <Name>mail</Name>
            <ParameterType>string</ParameterType>
            <SkosConcept>SKOS_MAIL</SkosConcept>
            <Unit>none</Unit>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>NAXIS1</Name>
            <ParameterType>integer</ParameterType>
            <SkosConcept>Number of pixels in horizontal axis</SkosConcept>
            <Unit>None</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>NAXIS2</Name>
            <ParameterType>integer</ParameterType>
            <SkosConcept>Number of pixels in vertical axis</SkosConcept>
            <Unit>None</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>CTYPE1</Name>
            <ParameterType>string</ParameterType>
            <SkosConcept>WCS Type of the horizontal coordinate, including coordinate and projection, each allowed three character</SkosConcept>
            <Unit>None</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>CTYPE2</Name>
            <ParameterType>string</ParameterType>
            <SkosConcept>WCS Type of the vertical coordinate, including coordinate and projection, each allowed three character</SkosConcept>
            <Unit>None</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>CRVAL1</Name>
            <ParameterType>real</ParameterType>
            <SkosConcept>Horizonal axis WCS value at the reference pixel</SkosConcept>
            <Unit>degree</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>CRVAL2</Name>
            <ParameterType>real</ParameterType>
            <SkosConcept>Vertical axis WCS value at the reference pixel</SkosConcept>
            <Unit>degree</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>CRPIX1</Name>
            <ParameterType>integer</ParameterType>
            <SkosConcept>Reference pixel on the horizonal axis</SkosConcept>
            <Unit>None</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>CRPIX2</Name>
            <ParameterType>integer</ParameterType>
            <SkosConcept>Reference pixel on the vertical axis</SkosConcept>
            <Unit>None</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>CDELT1</Name>
            <ParameterType>real</ParameterType>
            <SkosConcept>Change per pixel in horizonal axis WCS value at the reference pixel</SkosConcept>
            <Unit>degree</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>CDELT2</Name>
            <ParameterType>real</ParameterType>
            <SkosConcept>Change per pixel in vertical axis WCS value at the reference pixel</SkosConcept>
            <Unit>degree</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>CROTA2</Name>
            <ParameterType>real</ParameterType>
            <SkosConcept>Rotation angle of image around the reference pixel</SkosConcept>
            <Unit>degree</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>ImageLocation</Name>
            <ParameterType>string</ParameterType>
            <SkosConcept>Folder where the raw images are stored</SkosConcept>
            <Unit>None</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>EQUINOX</Name>
            <ParameterType>string</ParameterType>
            <SkosConcept>Rotation angle of image around the reference pixel</SkosConcept>
            <Unit>year</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
        <parameter>
            <Name>fileResult</Name>
            <ParameterType>string</ParameterType>
            <SkosConcept>url to the tar file containing the mosaiced fits files</SkosConcept>
            <Unit>None</Unit>
            <Precision xsi:type="AtomicConstantExpression" ConstantType="real">
                <Constant>0.0</Constant>
            </Precision>
            <Dimension xsi:type="AtomicConstantExpression" ConstantType="integer">
                <Constant>1</Constant>
            </Dimension>
        </parameter>
    </Parameters>
    <Inputs>
        <Name>inputs</Name>
        <ParameterGroup>
            <Name>Coordinates Header</Name>
            <ParameterRef ParameterName="NAXIS1"/>
            <ParameterRef ParameterName="NAXIS2"/>
            <ParameterRef ParameterName="CTYPE1"/>
            <ParameterRef ParameterName="CTYPE2"/>
            <ParameterRef ParameterName="CRVAL1"/>
            <ParameterRef ParameterName="CRVAL2"/>
            <ParameterRef ParameterName="CRPIX1"/>
            <ParameterRef ParameterName="CRPIX2"/>
            <ParameterRef ParameterName="CDELT1"/>
            <ParameterRef ParameterName="CDELT2"/>
            <ParameterRef ParameterName="CROTA2"/>
            <ParameterRef ParameterName="EQUINOX"/>
            <ParameterRef ParameterName="ImageLocation"/>
            <ConstraintOnGroup>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>Number of pixel in horizontal axis must be between 1 and 100000</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="NAXIS1"/>
                            </Expression>
                            <ConditionType xsi:type="ValueInRange">
<Sup reached="true">
    <Value xsi:type="AtomicConstantExpression" ConstantType="integer">
        <Constant>10000</Constant>
    </Value>
</Sup>
<Inf reached="true">
    <Value xsi:type="AtomicConstantExpression" ConstantType="integer">
        <Constant>1</Constant>
    </Value>
</Inf>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>Number of pixel in vertical axis must be between 1 and 100000</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="NAXIS2"/>
                            </Expression>
                            <ConditionType xsi:type="ValueInRange">
<Sup reached="true">
    <Value xsi:type="AtomicConstantExpression" ConstantType="integer">
        <Constant>10000</Constant>
    </Value>
</Sup>
<Inf reached="true">
    <Value xsi:type="AtomicConstantExpression" ConstantType="integer">
        <Constant>1</Constant>
    </Value>
</Inf>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>Horizonal axis WCS value at the reference pixel must be between 0 and 360</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="CRVAL1"/>
                            </Expression>
                            <ConditionType xsi:type="ValueInRange">
<Sup reached="true">
    <Value xsi:type="AtomicConstantExpression" ConstantType="real">
        <Constant>360</Constant>
    </Value>
</Sup>
<Inf reached="true">
    <Value xsi:type="AtomicConstantExpression" ConstantType="real">
        <Constant>0</Constant>
    </Value>
</Inf>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>Vertical axis WCS value at the reference pixel must be between -90 and 90</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="CRVAL2"/>
                            </Expression>
                            <ConditionType xsi:type="ValueInRange">
<Sup reached="true">
    <Value xsi:type="AtomicConstantExpression" ConstantType="real">
        <Constant>90</Constant>
    </Value>
</Sup>
<Inf reached="true">
    <Value xsi:type="AtomicConstantExpression" ConstantType="real">
        <Constant>-90</Constant>
    </Value>
</Inf>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>default value for EQUINOX is 2000</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="EQUINOX"/>
                            </Expression>
                            <ConditionType xsi:type="DefaultValue">
<Value xsi:type="AtomicConstantExpression" ConstantType="string">
    <Constant>2000</Constant>
</Value>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>The horizontal reference pixel should be included in the Image: CRPIX1&lt;=NAXIS1</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="NAXIS1"/>
<Operation operationType="MINUS">
    <expression xsi:type="AtomicParameterExpression">
        <parameterRef ParameterName="CRPIX1"/>
    </expression>
</Operation>
                            </Expression>
                            <ConditionType xsi:type="ValueLargerThan" reached="true">
<Value xsi:type="AtomicConstantExpression" ConstantType="integer">
    <Constant>0</Constant>
</Value>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>The vertical reference pixel should be included in the Image: CRPIX2&lt;=NAXIS2</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="NAXIS2"/>
<Operation operationType="MINUS">
    <expression xsi:type="AtomicParameterExpression">
        <parameterRef ParameterName="CRPIX2"/>
    </expression>
</Operation>
                            </Expression>
                            <ConditionType xsi:type="ValueLargerThan" reached="true">
<Value xsi:type="AtomicConstantExpression" ConstantType="integer">
    <Constant>0</Constant>
</Value>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>CDELT1 must be different from 0</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="CDELT1"/>
                            </Expression>
                            <ConditionType xsi:type="ValueDifferentFrom">
<Value xsi:type="AtomicConstantExpression" ConstantType="integer">
    <Constant>0</Constant>
</Value>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>CDELT2 must be different from 0</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="CDELT2"/>
                            </Expression>
                            <ConditionType xsi:type="ValueDifferentFrom">
<Value xsi:type="AtomicConstantExpression" ConstantType="integer">
    <Constant>0</Constant>
</Value>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
                <ConditionalStatement xsi:type="AlwaysConditionalStatement">
                    <comment>Default value for image location is 'SampleLocation'</comment>
                    <always>
                        <Criterion xsi:type="Criterion">
                            <Expression xsi:type="AtomicParameterExpression">
<parameterRef ParameterName="ImageLocation"/>
                            </Expression>
                            <ConditionType xsi:type="DefaultValue">
<Value xsi:type="AtomicConstantExpression" ConstantType="string">
    <Constant>SampleLocation</Constant>
</Value>
                            </ConditionType>
                        </Criterion>
                    </always>
                </ConditionalStatement>
            </ConstraintOnGroup>
        </ParameterGroup>
        <ParameterGroup>
            <Name>Technical parameters</Name>
            <ParameterRef ParameterName="mail"/>
        </ParameterGroup>
    </Inputs>
    <Outputs>
        <Name>outputs</Name>
        <ParameterRef ParameterName="fileResult"/>
    </Outputs>
</Service>
